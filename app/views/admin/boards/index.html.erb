<script type="text/javascript" charset="utf-8">
  function modify_main_menu(menu) {
    var new_menu = [];
    $.each(
      menu,
      function (index,item) {
        var add_tab = true;
        
        add_tab = !(/right/.test(item.id));
        // alleen tab new
        //         if (/right/.test(item.id)) {
        //           var target_index = item.id.replace(/^right_/,"");
        //  $("#page #main_menu .actions > li ").each(function(index, li) {
        //    if (index == target_index) {
        //      if (/articles\/new/.test(li.getElementsByTagName("A")[0].href)) {
        //        add_tab = false;
        //      }
        //    }
        //  });
        // }
					
				if (add_tab) {
          new_menu[new_menu.length] = item;
        }
      }
    );
    return new_menu;
  }
  
  
  //
  // Init CRUD
  //
  function extjs_body_items() {
    return init_lico_adva_crud({
      columns: [{
          label: 'titel',
          name: 'title',
          type: 'string',
          submit_value: 'board[title]'
        }, {
          label: 'omschrijving',
          name: 'description', 
          type: 'string',
          submit_value: 'board[description]'
		},{
		  label: 'Aantal Topics',
		  name: 'topics_count',
		  type: 'boolean',
      }],
      add_record_path: '<%= admin_boards_path(@site.id, @section) %>',
      store: {
        url: '<%= url_for admin_boards_path(@site.id, @section) %>.xml',
        sort: {
          by: 'title',
          order: 'asc'
        }
      },
      grid: {
        //empty_details: t['board']['selection_empty']
      },
      show: {
        url: '<%= edit_admin_board_path(@site, @section, '!recordid!') %>',
        custom_form: edit_board_form,
        custom_form_values: edit_board_form_values
      },
      edit: {
        url: '<%= admin_board_path(@site, @section, '!recordid!') %>'
      },
      destroy: {
        url: '<%= admin_board_path(@site, @section, '!recordid!') %>',
        //message: t['board']['delete_confirm']
      }
    });
  }
  
  function edit_board_form_values (parameters) {
    parameters["board[title]"] = document.getElementById('title').value;
    parameters["board[description]"] = document.getElementById('description').value;


  	return parameters;
  }
  
  function edit_board_form (record) {
    var title = xmlvalue(record,"title");
    var description = xmlvalue(record,"description");
    selected_record_title = title;

  	return [{
      xtype: 'tabpanel',
      plain: true,
      activeTab: 0,
      defaults: {
        bodyStyle: 'padding:10px'
      },
      items: [{
        title: 'Forum',
        layout: 'column',
        border: false,
        items: [{
          columnWidth: .5,
          layout: 'form',
          border: false,
          items: [{
            xtype: 'textfield',
            fieldLabel: 'titel',
            id: 'title',
            name: 'title',
            anchor: '95%',
            value: title
          }, {
            xtype: 'textfield',
            fieldLabel: 'omschrijving',
            id: 'description',
            name: 'description',
            anchor: '95%',
            value: description
          }]
        }]
      }]
    }];
  }
</script>
<% content_for :sidebar do -%>
<% end -%>
