/* Copyright (c) 2007 Brandon Aaron (brandon.aaron@gmail.com || http://brandonaaron.net)
 * Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php) 
 * and GPL (http://www.opensource.org/licenses/gpl-license.php) licenses.
 *
 * Version: 1.0.2
 * Requires jQuery 1.1.3+
 * Docs: http://docs.jquery.com/Plugins/livequery
 */
(function(JQ){JQ.extend(JQ.fn,{livequery:function(type,fn,fn2){var self=this,q;if(JQ.isFunction(type))fn2=fn,fn=type,type=undefined;JQ.each(JQ.livequery.queries,function(i,query){if(self.selector==query.selector&&self.context==query.context&&type==query.type&&(!fn||fn.JQlqguid==query.fn.JQlqguid)&&(!fn2||fn2.JQlqguid==query.fn2.JQlqguid))return(q=query)&&false;});q=q||new JQ.livequery(this.selector,this.context,type,fn,fn2);q.stopped=false;JQ.livequery.run(q.id);return this;},expire:function(type,fn,fn2){var self=this;if(JQ.isFunction(type))fn2=fn,fn=type,type=undefined;JQ.each(JQ.livequery.queries,function(i,query){if(self.selector==query.selector&&self.context==query.context&&(!type||type==query.type)&&(!fn||fn.JQlqguid==query.fn.JQlqguid)&&(!fn2||fn2.JQlqguid==query.fn2.JQlqguid)&&!this.stopped)JQ.livequery.stop(query.id);});return this;}});JQ.livequery=function(selector,context,type,fn,fn2){this.selector=selector;this.context=context||document;this.type=type;this.fn=fn;this.fn2=fn2;this.elements=[];this.stopped=false;this.id=JQ.livequery.queries.push(this)-1;fn.JQlqguid=fn.JQlqguid||JQ.livequery.guid++;if(fn2)fn2.JQlqguid=fn2.JQlqguid||JQ.livequery.guid++;return this;};JQ.livequery.prototype={stop:function(){var query=this;if(this.type)this.elements.unbind(this.type,this.fn);else if(this.fn2)this.elements.each(function(i,el){query.fn2.apply(el);});this.elements=[];this.stopped=true;},run:function(){if(this.stopped)return;var query=this;var oEls=this.elements,els=JQ(this.selector,this.context),nEls=els.not(oEls);this.elements=els;if(this.type){nEls.bind(this.type,this.fn);if(oEls.length>0)JQ.each(oEls,function(i,el){if(JQ.inArray(el,els)<0)JQ.event.remove(el,query.type,query.fn);});}else{nEls.each(function(){query.fn.apply(this);});if(this.fn2&&oEls.length>0)JQ.each(oEls,function(i,el){if(JQ.inArray(el,els)<0)query.fn2.apply(el);});}}};JQ.extend(JQ.livequery,{guid:0,queries:[],queue:[],running:false,timeout:null,checkQueue:function(){if(JQ.livequery.running&&JQ.livequery.queue.length){var length=JQ.livequery.queue.length;while(length--)JQ.livequery.queries[JQ.livequery.queue.shift()].run();}},pause:function(){JQ.livequery.running=false;},play:function(){JQ.livequery.running=true;JQ.livequery.run();},registerPlugin:function(){JQ.each(arguments,function(i,n){if(!JQ.fn[n])return;var old=JQ.fn[n];JQ.fn[n]=function(){var r=old.apply(this,arguments);JQ.livequery.run();return r;}});},run:function(id){if(id!=undefined){if(JQ.inArray(id,JQ.livequery.queue)<0)JQ.livequery.queue.push(id);}else
JQ.each(JQ.livequery.queries,function(id){if(JQ.inArray(id,JQ.livequery.queue)<0)JQ.livequery.queue.push(id);});if(JQ.livequery.timeout)clearTimeout(JQ.livequery.timeout);JQ.livequery.timeout=setTimeout(JQ.livequery.checkQueue,20);},stop:function(id){if(id!=undefined)JQ.livequery.queries[id].stop();else
JQ.each(JQ.livequery.queries,function(id){JQ.livequery.queries[id].stop();});}});JQ.livequery.registerPlugin('append','prepend','after','before','wrap','attr','removeAttr','addClass','removeClass','toggleClass','empty','remove');JQ(function(){JQ.livequery.play();});var init=JQ.prototype.init;JQ.prototype.init=function(a,c){var r=init.apply(this,arguments);if(a&&a.selector)r.context=a.context,r.selector=a.selector;if(typeof a=='string')r.context=c||document,r.selector=a;return r;};JQ.prototype.init.prototype=JQ.prototype;})(jQuery);